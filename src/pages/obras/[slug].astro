---
// src/pages/obras/[slug].astro
import Layout from "../../layouts/Layout.astro";
import { getAllObras, getObraBySlug } from "../../lib/wp-graphql";
import Image from "astro/components/Image.astro";

// PASO 1: getStaticPaths obtiene la LISTA de todas las obras para decirle a Astro qué páginas crear.
export async function getStaticPaths() {
  const todasLasObras = await getAllObras();

  return todasLasObras.map((obra) => ({
    params: { slug: obra.slug },
  }));
}

const { slug } = Astro.params;
const obra = await getObraBySlug(slug!);
---

<Layout title={`${obra.title} | Beatriz Estebanez`}>
  <div class="max-w-6xl mx-auto px-4 py-8 md:py-16">
    <div class="flex grid-cols-1 md:grid-cols-5 md:gap-12">
      <div class="md-col-span-3 mb-8 md:mb-0">
        <Image
          class="rounded-lg shadow-2xl min-h-100 min-w-100"
          src={obra.featuredImage?.node.sourceUrl}
          alt={obra.featuredImage?.node.altText}
          width={100}
          height={100}
        />
      </div>
      <div class="md-col-span-2">
        <h1
          class="text-4xl md:text-5xl font-bold text-gray-600 font-heading mb-4"
        >
          {obra.title}
        </h1>

        <blockquote
          class="border-l-4 border-gray-400 pl-4 italic text-gray-700 text-3xl mb-6"
        >
          <p class="mr-60">
            ‘{obra.datosDeLaObra?.textoNarrativo}’
          </p>
        </blockquote>

        <h2 class="text-2xl uppercase tracking-widest text-zinc-500 mb-2">
          Sobre la Obra
        </h2>
        <p
          class="font-sans text-md text-gray-500 leading-relaxed mb-6 text-pretty text-justify"
        >
          {obra.datosDeLaObra?.descripcion}
        </p>

        <div class="flex gap-x-30 justify-start">
          <div class="pr-1">
            <h3 class="text-sm uppercase tracking-widest text-zinc-500 mb-2">
              Técnica
            </h3>
            <p class="text-xl text-zinc-800">{obra.datosDeLaObra?.tecnica}</p>
          </div>
          <div class="pr-1">
            <h3 class="text-sm uppercase tracking-widest text-zinc-500 mb-2">
              Dimensiones
            </h3>
            <p class="text-xl text-zinc-800">
              {obra.datosDeLaObra?.dimensiones}
            </p>
          </div>
          <div class="pr-1">
            <h3 class="text-sm uppercase tracking-widest text-zinc-500 mb-2">
              Año
            </h3>
            <p class="text-xl text-zinc-800">{obra.datosDeLaObra?.ano}</p>
          </div>
        </div>
        <div class="mt-8">
          <a href="/obras" class="text-pink-600 hover:underline">
            &larr; Volver a la galería
          </a>
        </div>
      </div>
    </div>
  </div>
</Layout>
